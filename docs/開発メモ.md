### 1ï¸âƒ£ Ruby / Rails ãƒãƒ¼ã‚¸ãƒ§ãƒ³è¡çªå•é¡Œ

#### ğŸ ç™ºç”Ÿã—ãŸå•é¡Œ

```
Rails new å®Ÿè¡Œæ™‚ã€ä»¥ä¸‹ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿï¼š

Gem::GemNotFoundException: can't find gem railties (= 6.1.7.8)
ã¾ãŸã€"Your Ruby version is 3.1.1, but your Gemfile specified 3.1.4" ã¨ã„ã†ãƒãƒ¼ã‚¸ãƒ§ãƒ³ä¸ä¸€è‡´ã‚‚ç™ºç”Ÿã€‚
```

#### ğŸ”§ åŸå› 

* ãƒ­ãƒ¼ã‚«ãƒ« Ruby ãŒ `3.1.1` ã®ã¾ã¾ãªã®ã«ã€Gemfile ã§ã¯ `3.1.4` ãŒæŒ‡å®šã•ã‚Œã¦ã„ãŸã€‚
* ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ä¾å­˜ã‚„ bundler ã¨ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³å·®ç•°ãŒåŸå› ã§ãƒ“ãƒ«ãƒ‰ãŒå¤±æ•—ã€‚

#### âœ… å¯¾å¿œæ–¹æ³•

```
Gemfile ã® ruby ã®æŒ‡å®šã‚’ 3.1.1 ã«å¤‰æ›´ã—ç›´ã—ã€bundle install ã‚’å®Ÿè¡Œã€‚
```

```ruby
ruby '3.1.1'
```

---

### 2ï¸âƒ£ libmysqlclient-dev ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚¨ãƒ©ãƒ¼

#### ğŸ ç™ºç”Ÿã—ãŸå•é¡Œ

```
E: Package 'libmysqlclient-dev' has no installation candidate
docker compose build ãŒã‚¨ãƒ©ãƒ¼çµ‚äº†
```

#### ğŸ”§ åŸå› 

* Dockerãƒ™ãƒ¼ã‚¹ OS ãŒ Debian Bookworm ã®ãŸã‚ã€
  `libmysqlclient-dev` ãŒãƒªãƒã‚¸ãƒˆãƒªæä¾›å¯¾è±¡å¤–ã¨ãªã‚Šã€ä»£æ›¿ãŒå¿…è¦ã ã£ãŸã€‚

#### âœ… è§£æ±ºæ–¹æ³•

Dockerfileä¿®æ­£ï¼š

```Dockerfile
apt-get install -y build-essential libmariadb-dev libmariadb-dev-compat nodejs
```

---

### 3ï¸âƒ£ create-next-app ãŒæ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ã¨è¡çª

#### ğŸ ç™ºç”Ÿã—ãŸå•é¡Œ

```
The directory frontend contains files that could conflict:
  Dockerfile
```

#### ğŸ”§ åŸå› 

* Next.js ã® CLI ã¯ã€æ—¢å­˜ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä¸Šã§ã¯å®Ÿè¡Œä¸å¯ä»•æ§˜ã€‚

#### âœ… è§£æ±ºæ–¹æ³•

ä¸€æ™‚çš„ã« Dockerfile ã‚’é€€é¿ã—ã¦ã‹ã‚‰å®Ÿè¡Œï¼š

```sh
mv Dockerfile ../Dockerfile.frontend.bak
npx create-next-app@latest . --ts
mv ../Dockerfile.frontend.bak Dockerfile
```

---

### 4ï¸âƒ£ npm install ãŒ Docker å†…ã§å¤±æ•—ï¼ˆECONNRESETï¼‰

#### ğŸ ç™ºç”Ÿã—ãŸå•é¡Œ

```
npm ERR! code ECONNRESET
npm ERR! network aborted
```

#### ğŸ”§ åŸå› 

* ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆï¼ˆDockerå†… npm install ãŒé€”ä¸­ã§åˆ‡æ–­ã•ã‚ŒãŸå¯èƒ½æ€§ï¼‰

#### âœ… å¯¾å¿œ

å†å®Ÿè¡Œã§æˆåŠŸã€‚ï¼ˆç¾è±¡ä¸€æ™‚çš„ï¼‰

---

# Railsèµ·å‹•æ™‚ã« Logger å®šæ•°æœªå®šç¾©ã‚¨ãƒ©ãƒ¼
Ruby æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã® Logger ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ãªã„çŠ¶æ…‹ã§ã€ActiveSupport ãŒ Logger ã‚’ä½¿ãŠã†ã¨ã—ã¦ã‚³ã‚±ã¦ã„ã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã€‚
/config/boot.rb ã« require "logger" ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§è§£æ¶ˆã€‚

# Rails ãŒ /tmp/mysql.sock ã«ç¹‹ã”ã†ã¨ã—ã¦å¤±æ•—
Docker ç’°å¢ƒã§ã¯ config/database.yml ã® host ã‚’ db ã«ã—ã€
mysql2 ã®æ¥ç¶šå…ˆã‚’ docker-compose ã®ã‚µãƒ¼ãƒ“ã‚¹åã«åˆã‚ã›ã‚‹ã“ã¨ã§è§£æ¶ˆã€‚

# Debian bookworm ã§ libmysqlclient-dev ãŒå…¥ã‚‰ãªã„

Dockerfile ã§
apt-get install -y build-essential libmysqlclient-dev nodejs
ã¨ã—ã¦ã„ãŸã¨ã“ã‚ã€Debian bookworm ã§ã¯ `libmysqlclient-dev` ãŒæä¾›ã•ã‚Œã¦ãŠã‚‰ãšã€
> Package 'libmysqlclient-dev' has no installation candidate
ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã€‚
=> ä»¥ä¸‹ã®ã‚ˆã†ã« MariaDB ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«ç½®ãæ›ãˆã¦è§£æ¶ˆã€‚
  apt-get install -y build-essential libmariadb-dev-compat libmariadb-dev nodejs

# Rails èµ·å‹•æ™‚ã« Logger ã® NameError
ã‚¨ãƒ©ãƒ¼å†…å®¹ï¼š
    uninitialized constant ActiveSupport::LoggerThreadSafeLevel::Logger (NameError)
Rails 6.1.7.x + Ruby 3.1 ã®çµ„ã¿åˆã‚ã›ã§ç™ºç”Ÿã€‚
ActiveSupport ãŒ Logger::Severity ã‚’å‚ç…§ã™ã‚‹ã¨ãã«ã€æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒª Logger ãŒã¾ã  require ã•ã‚Œã¦ã„ãªã„ã“ã¨ãŒåŸå› ã€‚
=> backend/config/boot.rb ã«ä»¥ä¸‹ã‚’è¿½åŠ ã—ã€è§£æ¶ˆã€‚
    require 'bundler/setup'
    require 'logger'          # â˜… è¿½åŠ 
    require 'bootsnap/setup'

# appãƒ¦ãƒ¼ã‚¶ãƒ¼ã§test DBä½œæˆæ™‚ã«Access denied
=> MySQLå…¬å¼ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ MYSQL_USER ã«å¯¾ã—ã¦ MYSQL_DATABASE ã®æ¨©é™ã—ã‹ä»˜ä¸ã—ãªã„ãŸã‚ã€
   testç’°å¢ƒDB(backend_test)ä½œæˆæ™‚ã«appãƒ¦ãƒ¼ã‚¶ãƒ¼ã§æ¨©é™ä¸è¶³ã¨ãªã£ãŸã€‚
   database.ymlã®testç’°å¢ƒã ã‘username/passwordã‚’root/passwordã«å¤‰æ›´ã—ã€
   docker compose run --rm api bundle exec rails db:create db:migrate ã§è§£æ¶ˆã€‚
â€»ãƒ†ã‚¹ãƒˆã¯å½“é¢ä½¿ã‚ãªã„ & PoC ãªã®ã§ã€testç’°å¢ƒã ã‘ root ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§DBã‚’ä½œã‚‹ã‚ˆã†ã«ã—ãŸã€‚